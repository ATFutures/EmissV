<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vehicular Emissions by Top-Down Methods â€¢ EmissV</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">EmissV</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atmoschem/EmissV">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="emissv" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#emissv" class="anchor"></a>EmissV</h1></div>

<p>This package provide some methods to create emissions (with a focus on vehicular emissions) for use in numeric air quality models sush as <a href="https://ruc.noaa.gov/wrf/wrf-chem/">WRF-Chem</a>.</p>
<div id="to-install" class="section level2">
<h2 class="hasAnchor">
<a href="#to-install" class="anchor"></a>To install</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"atmoschem/EmissV"</span>)
<span class="kw">library</span>(EmissV)</code></pre></div>
<div id="system-dependencies" class="section level3">
<h3 class="hasAnchor">
<a href="#system-dependencies" class="anchor"></a>System dependencies</h3>
<p>EmissV import functions from <a href="http://cran.r-project.org/package=ncdf4">ncdf4</a> for read model information, <a href="http://cran.r-project.org/package=raster">raster</a> to process grinded information and <a href="https://github.com/edzer/units/">units</a>.</p>
</div>
<div id="ubuntu-instalation" class="section level3">
<h3 class="hasAnchor">
<a href="#ubuntu-instalation" class="anchor"></a>Ubuntu instalation</h3>
<p>The following steps are required for installation on Ubuntu:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="fu">sudo</span> add-apt-repository ppa:ubuntugis/ubuntugis-unstable --yes
  <span class="fu">sudo</span> apt-get --yes --force-yes update -qq
  <span class="co"># units/udunits2 dependency:</span>
  <span class="fu">sudo</span> apt-get install --yes libudunits2-dev
  <span class="co"># sf dependencies (without libudunits2-dev):</span>
  <span class="fu">sudo</span> apt-get install --yes libgdal-dev libgeos-dev libproj-dev
  <span class="co"># netcdf dependencies:</span>
  <span class="fu">sudo</span> apt-get install --yes libnetcdf-dev netcdf-bin</code></pre></div>
</div>
<div id="fedora-instalation" class="section level3">
<h3 class="hasAnchor">
<a href="#fedora-instalation" class="anchor"></a>Fedora instalation</h3>
<p>The following steps are required for installation on Fedora:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">  <span class="fu">sudo</span> dnf update
  <span class="co"># units/udunits2 dependency:</span>
  <span class="fu">sudo</span> yum install udunits2-devel
  <span class="co"># sf dependencies (without libudunits2-dev):</span>
  <span class="fu">sudo</span> yum install gdal-devel proj-devel proj-epsg proj-nad geos-devel
  <span class="co"># netcdf dependencies:</span>
  <span class="fu">sudo</span> yum install netcdf-devel</code></pre></div>
</div>
<div id="windowns-instalation" class="section level3">
<h3 class="hasAnchor">
<a href="#windowns-instalation" class="anchor"></a>Windowns instalation</h3>
<p>No aditional steps for windowns installation.</p>
</div>
</div>
<div id="using-emissv" class="section level2">
<h2 class="hasAnchor">
<a href="#using-emissv" class="anchor"></a>Using EmissV</h2>
<p>In EmissV the vehicular emissions are estimated by a top-down approach. The following steps show an example workflow for calculating vehicular emissions, these emissions are initially temporally and spatially disaggregated, and then distributed spatially and temporally.</p>
<p><strong>I.</strong> Total: emission of pollutants is estimated from the fleet, use and emission factors and for interest area (cityes, states, countries, etc).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(EmissV)

veiculos &lt;-<span class="st"> </span><span class="kw"><a href="reference/vehicles.html">vehicles</a></span>(<span class="dt">example =</span> T)
<span class="co"># using a example of vehicles (DETRAN 2016 data and SP vahicle distribution):</span>
<span class="co">#                              Category   Type Fuel      Use       SP ...</span>
<span class="co"># Light Duty Vehicles Gasohol   LDV_E25    LDV  E25  41 km/d 11624342 ...</span>
<span class="co"># Light Duty Vehicles Ethanol  LDV_E100    LDV E100  41 km/d   874627 ...</span>
<span class="co"># Light Duty Vehicles Flex        LDV_F    LDV FLEX  41 km/d  9845022 ...</span>
<span class="co"># Diesel Trucks               TRUCKS_B5 TRUCKS   B5 110 km/d   710634 ...</span>
<span class="co"># Diesel Urban Busses           CBUS_B5    BUS   B5 165 km/d   792630 ...</span>
<span class="co"># Diesel Intercity Busses       MBUS_B5    BUS   B5 165 km/d    21865 ...</span>
<span class="co"># Gasohol Motorcycles          MOTO_E25   MOTO  E25 140 km/d  3227921 ...</span>
<span class="co"># Flex Motorcycles               MOTO_F   MOTO FLEX 140 km/d   235056 ...</span>

veiculos &lt;-<span class="st"> </span>veiculos[,<span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="op">-</span><span class="dv">8</span>,<span class="op">-</span><span class="dv">9</span>)] <span class="co"># dropping RJ, PR and SC</span>

EF     &lt;-<span class="st"> </span><span class="kw"><a href="reference/emissionFactor.html">emissionFactor</a></span>(<span class="dt">example =</span> T)
<span class="co"># using a example emission factor (values calculated from CETESB 2015):</span>
<span class="co">#                                     CO          PM</span>
<span class="co"># Light duty Vehicles Gasohol  1.75 g/km 0.0013 g/km</span>
<span class="co"># Light Duty Vehicles Ethanol 10.04 g/km 0.0000 g/km</span>
<span class="co"># Light Duty Vehicles Flex     0.39 g/km 0.0010 g/km</span>
<span class="co"># Diesel trucks                0.45 g/km 0.0612 g/km</span>
<span class="co"># Diesel urban busses          0.77 g/km 0.1052 g/km</span>
<span class="co"># Diesel intercity busses      1.48 g/km 0.1693 g/km</span>
<span class="co"># Gasohol motorcycles          1.61 g/km 0.0000 g/km</span>
<span class="co"># Flex motorcycles             0.75 g/km 0.0000 g/km</span>

TOTAL  &lt;-<span class="st"> </span><span class="kw"><a href="reference/totalEmission.html">totalEmission</a></span>(veiculos,EF,<span class="dt">pol =</span> <span class="kw">c</span>(<span class="st">"CO"</span>),<span class="dt">verbose =</span> T)
<span class="co"># [1] "Total of CO : 1127549.20226849 t year-1"</span></code></pre></div>
<p><strong>II.</strong> Spatial distribution: The package has functions to read information from tables, georeferenced images (tiff), shapefiles (sh), OpenStreet maps (osm), global inventories in NetCDF format (nc) to calculate point, line and area sources.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">raster &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(<span class="kw">paste</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"EmissV"</span>),
                         <span class="st">"/dmsp.tiff"</span>,<span class="dt">sep=</span><span class="st">""</span>))

grid   &lt;-<span class="st"> </span><span class="kw"><a href="reference/gridInfo.html">gridInfo</a></span>(<span class="kw">paste</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"EmissV"</span>),
                   <span class="st">"/wrfinput_d02"</span>,<span class="dt">sep=</span><span class="st">""</span>))
<span class="co"># [1] "Grid information from: .../EmissV/extdata/wrfinput_d02"</span>

shape  &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/raster/topics/shapefile">shapefile</a></span>(<span class="kw">paste</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"EmissV"</span>),
                            <span class="st">"/BR.shp"</span>,<span class="dt">sep=</span><span class="st">""</span>),<span class="dt">verbose =</span> F)[<span class="dv">12</span>,<span class="dv">1</span>]
MG     &lt;-<span class="st"> </span><span class="kw"><a href="reference/areaSource.html">areaSource</a></span>(shape,raster,grid,<span class="dt">name =</span> <span class="st">"Minas Gerais"</span>)
<span class="co"># [1] "processing Minas Gerais area ... "</span>
<span class="co"># [1] "fraction of Minas Gerais area inside the domain = 0.0145921494236101"</span>

shape  &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/raster/topics/shapefile">shapefile</a></span>(<span class="kw">paste</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"EmissV"</span>),
                            <span class="st">"/BR.shp"</span>,<span class="dt">sep=</span><span class="st">""</span>),<span class="dt">verbose =</span> F)[<span class="dv">22</span>,<span class="dv">1</span>]
SP     &lt;-<span class="st"> </span><span class="kw"><a href="reference/areaSource.html">areaSource</a></span>(shape,raster,grid,<span class="dt">name =</span> <span class="st">"Sao Paulo"</span>)
<span class="co"># [1] "processing Sao Paulo area ... "</span>
<span class="co"># [1] "fraction of Sao Paulo area inside the domain = 0.474658563750987"</span>

sp<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sp/topics/spplot">spplot</a></span>(raster<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/raster/topics/merge">merge</a></span>(TOTAL[[<span class="dv">1</span>]][[<span class="dv">1</span>]] <span class="op">*</span><span class="st"> </span>SP, TOTAL[[<span class="dv">1</span>]][[<span class="dv">2</span>]] <span class="op">*</span><span class="st"> </span>MG),
           <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">draw=</span><span class="ot">TRUE</span>),<span class="dt">ylab=</span><span class="st">"Lat"</span>,<span class="dt">xlab=</span><span class="st">"Lon"</span>,
           <span class="dt">main=</span><span class="kw">list</span>(<span class="dt">label=</span><span class="st">"Emissions of CO [g/d]"</span>),
           <span class="dt">col.regions =</span> <span class="kw">c</span>(<span class="st">"#031638"</span>,<span class="st">"#001E48"</span>,<span class="st">"#002756"</span>,<span class="st">"#003062"</span>,
                           <span class="st">"#003A6E"</span>,<span class="st">"#004579"</span>,<span class="st">"#005084"</span>,<span class="st">"#005C8E"</span>,
                           <span class="st">"#006897"</span>,<span class="st">"#0074A1"</span>,<span class="st">"#0081AA"</span>,<span class="st">"#008FB3"</span>,
                           <span class="st">"#009EBD"</span>,<span class="st">"#00AFC8"</span>,<span class="st">"#00C2D6"</span>,<span class="st">"#00E3F0"</span>))</code></pre></div>
<p><img src="https://raw.githubusercontent.com/atmoschem/EmissV/master/CO_all.png" alt="Figure 1 - Emissions of CO using nocturnal lights."></p>
<p><strong>III.</strong> Emission calculation: calculate the final emission from all different sources and converts to model unit and resolution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CO_emissions &lt;-<span class="st"> </span><span class="kw"><a href="reference/emission.html">emission</a></span>(TOTAL,<span class="st">"CO"</span>,<span class="kw">list</span>(<span class="dt">SP =</span> SP, <span class="dt">MG =</span> MG),grid,<span class="dt">mm=</span><span class="dv">28</span>, <span class="dt">plot =</span> T)
<span class="co"># [1] "calculating emissions for CO using molar mass = 28 ..."</span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/atmoschem/EmissV/master/CO_final.png" alt="Figure 2 - CO emissions ready for use in air quality model."></p>
<p><strong>IV.</strong> Temporal distribution: the package has a set of hourly profiles that represent the mean activity for each day of the week calculated from traffic counts of toll stations located in SÃ£o Paulo city.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(perfil)
<span class="kw">names</span>(perfil)</code></pre></div>
<p>The package has additional functions for read netcdf data, create line and point sources (with plume rise) and to estimate the total emissions of of volatile organic compounds from exhaust (through the exhaust pipe), liquid (carter and evaporative) and vapor (fuel transfer operations).</p>
<p>Functions:</p>
<ul>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/read.html">read</a>: read global inventories in netcdf format</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/vehicles.html">vehicles</a>: tool to set-up vehicle data.table</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/emissionFactor.html">emissionFactor</a>: tool to set-up emission factors data.table</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/gridInfo.html">gridInfo</a>: read grid information from a NetCDF file</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/pointSource.html">pointSource</a>: emissions from point sources</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/plumeRise.html">plumeRise</a>: calculate plume rise</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/rasterSource.html">rasterSource</a>: distribution of emissions by a georeferenced image</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/lineSource.html">lineSource</a>: distribution of emissions by line vectors</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/streetDist.html">streetDist</a>: distribution by OpenStreetnMap street (in progress)</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/areaSource.html">areaSource</a>: distribution of emissions by region</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/totalEmission.html">totalEmission</a>: total emissions</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/totalVOC.html">totalVOC</a>: total VOCs emission</li>
<li>
<a href="https://atmoschem.github.io/EmissV/reference/emission.html">emission</a>: Emissions to atmospheric models</li>
</ul>
<p>Sample datasets:</p>
<ul>
<li>Perfil: vehicle counting profile for vehicular activity</li>
<li>Sample of an image of persistent lights of the Defense Meteorological Satellite Program (DMSP)</li>
<li>CETESB 2015 emission factors as <code><a href="reference/emissionFactor.html">emissionFactor(example=T)</a></code>
</li>
<li>DETRAN 2016 data and SP vahicle distribution as <code><a href="reference/vehicles.html">vehicles(example=T)</a></code>
</li>
<li>Shapefiles for Brazil states</li>
</ul>
<div id="meta" class="section level3">
<h3 class="hasAnchor">
<a href="#meta" class="anchor"></a>Meta</h3>
<p>Bug reports, suggestions, and code contributions are all welcome. Please see <a href="https://github.com/atmoschem/EmissV/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a> for details. Note that this project adopt the <a href="https://github.com/atmoschem/EmissV/blob/master/CONDUCT.md">Contributor Code of Conduct</a> and by participating in this project you agree to abide by its terms.</p>
</div>
<div id="licence" class="section level3">
<h3 class="hasAnchor">
<a href="#licence" class="anchor"></a>Licence</h3>
<p>EmissV is published under the terms of the MIT License. Copyright (c) 2018 Daniel Schuch.</p>
</div>
<div id="about-this-package" class="section level3">
<h3 class="hasAnchor">
<a href="#about-this-package" class="anchor"></a>About this package</h3>
<p>EmissV is a tool developed during Daniel Schuchâ€™s post-doctorate at the at the Department of Atmospheric Sciences, University of SÃ£o Paulo (<a href="http://www.iag.usp.br/atmosfericas/">IAG-USP</a>) supervised by professor Edmilson Dias de Freitas.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/atmoschem/EmissV">https://â€‹github.com/â€‹atmoschem/â€‹EmissV</a>
</li>
<li>Report a bug at <br><a href="https://github.com/atmoschem/EmissV/issues/">https://â€‹github.com/â€‹atmoschem/â€‹EmissV/â€‹issues/â€‹</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Daniel Schuch <br><small class="roles"> Author, maintainer </small> <br><small>(0000-0001-5977-4519)</small>
</li>
<li>Sergio Ibarra-Espinosa <br><small class="roles"> Author </small> <br><small>(0000-0002-3162-1905)</small>
</li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/atmoschem/EmissV"><img src="https://travis-ci.org/atmoschem/EmissV.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/Schuch666/emissv"><img src="https://ci.appveyor.com/api/projects/status/guuaaklaw6uyn4lj?svg=true" alt="Build status"></a></li>
</ul>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Daniel Schuch, Sergio Ibarra-Espinosa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
